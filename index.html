<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Health Insurance Risk Calculator</title>
        <link rel="stylesheet" href="index.css">
    </head>
    
    <body>
        <div class="container">
            <h1>Health Insurance Risk Calculator</h1>

            <div id="instructions">
                <p>Please enter the customer's health information to determine their insurance risk.</p>
            </div>

            <form id="riskForm">
                <label for="age">Age:</label>
                <input type="number" id="age" name="age" min="1" required><br>

                <label for="heightFeet">Height (Feet):</label>
                <input type="number" id="heightFeet" name="heightFeet" min="2" required><br>

                <label for="heightInches">Height (Inches):</label>
                <input type="number" id="heightInches" name="heightInches" min="0" max="11" required><br>

                <label for="weight">Weight (Pounds):</label>
                <input type="number" id="weight" name="weight" min="1" required><br>
                
                <label for="bloodPressure">Blood Pressure:</label>
                <input type="range" id="bloodPressure" name="bloodPressure" min="50" max="200" value="50" required><br>
                <span id="bloodPressureValue">50</span>

                <label for="familyHistory">Family History (check all that apply):</label><br>
                <div class="checkbox-container">
                    <input type="checkbox" id="diabetes" name="familyHistory" value="diabetes">
                    <label for="diabetes">Diabetes</label><br>

                    <input type="checkbox" id="cancer" name="familyHistory" value="cancer">
                    <label for="cancer">Cancer</label><br>

                    <input type="checkbox" id="alzheimers" name="familyHistory" value="alzheimers">
                    <label for="alzheimers">Alzheimerâ€™s</label><br>
                </div>

                <button type="submit">Calculate Risk</button>
            </form>

            <div id="result"></div>
        </div>

        <script src="index.js"></script>
        <script>
            const slider = document.getElementById('bloodPressure');
            const displayValue = document.getElementById('bloodPressureValue');
            slider.addEventListener('input', function() {displayValue.textContent = `${this.value} mmHg`;});
        </script>
        <script>
            document.getElementById('riskForm').addEventListener('submit', async function(event) {
                event.preventDefault();
        
                // Collect form data from user
                const age = parseInt(document.getElementById('age').value);
                const heightFeet = parseInt(document.getElementById('heightFeet').value);
                const heightInches = parseInt(document.getElementById('heightInches').value);
                const weight = parseInt(document.getElementById('weight').value);
                const bloodPressure = parseInt(document.getElementById('bloodPressure').value);
        
                const familyHistory = [];
                if (document.getElementById('diabetes').checked) familyHistory.push('diabetes');
                if (document.getElementById('cancer').checked) familyHistory.push('cancer');
                if (document.getElementById('alzheimers').checked) familyHistory.push('alzheimers');
        
                // Prepare data to send
                const requestData = {
                    age: age,
                    weight: weight,
                    heightFeet: heightFeet,
                    heightInches: heightInches,
                    bloodPressure: bloodPressure,
                    familyHistory: familyHistory
                };
        
                // Send data to the server
                const response = await fetch('https://health-insurance-api-hyaydcbwdxc3dxgc.centralus-01.azurewebsites.net/calculateRisk', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestData)
                });
        
                const result = await response.json(); // Parse the JSON response
        
                // Display the result
                document.getElementById('result').innerText = `Risk Score: ${result.riskScore}, Category: ${result.riskCategory}`;
            });
        </script>
    </body>
</html>